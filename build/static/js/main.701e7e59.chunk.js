(this.webpackJsonpcrack=this.webpackJsonpcrack||[]).push([[0],{41:function(e,t,a){e.exports=a(71)},70:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),l=a.n(c),o=a(6),s=a(4),m=a(8),u=a(5),i=a.n(u),d=a(14),p=a(22),E=a.n(p),f=function(e){var t=e.marketLoaded,a=Object(n.useRef)(null),c=Object(n.useCallback)((function(){return t.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.location.coordinates[0],e.location.coordinates[1]]},properties:{marketName:e.name,icon:"shop"}}}))}),[t]);return Object(n.useEffect)((function(){var e=c();E.a.accessToken="pk.eyJ1Ijoic2FtYWRvciIsImEiOiJja2FleWtoM3MyNHl4MnpwNGVldXBlbm9xIn0.hGo-e-FNZ_1tijtWyQT_xA";var t=new E.a.Map({container:a.current,style:"mapbox://styles/mapbox/streets-v11",zoom:9,center:[3.361881,6.672557]});return t.addControl(new E.a.NavigationControl,"bottom-right"),t.on("load",Object(d.a)(i.a.mark((function a(){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.addSource("point",{type:"geojson",data:{type:"FeatureCollection",features:e}}),t.addLayer({id:"points",type:"symbol",source:"point",layout:{"icon-image":"{icon}-15","icon-size":1.5,"text-field":"{marketName}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.9],"text-anchor":"top"}});case 2:case"end":return a.stop()}}),a)})))),function(){return t.remove()}}),[c]),r.a.createElement("div",{className:"my-5"},r.a.createElement("div",{ref:a,style:{width:"100%",height:"500px",borderRadius:"5px"}}))},b=a(3),g=function(){var e=Object(b.c)((function(e){return{market:e.market}})).market.filterMarket;return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"list-unstyled list-group list-group-flush container"},e&&e.map((function(e){return r.a.createElement("li",{key:e._id,className:"list-group-item"},r.a.createElement(o.b,{to:"/details/".concat(e._id)},e.name))}))))},O=a(12),R=a.n(O),v=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"ALERT_ERROR",payload:{status:e,msg:t.message,id:a}}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"ALERT_SUCCESS",payload:{status:e,msg:t.message,id:a}}},k=function(){return function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"LOAD_REQUEST"}),e.next=4,R.a.get("/api/v1/market");case 4:a=e.sent,t({type:"FETCH_MARKET",payload:a.data}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t({type:"FETCH_MARKET_ERROR"}),t(v(e.t0.response.status,e.t0.response.data,"FETCH_MARKET_ERROR"));case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},h=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(b.b)(),o=Object(b.c)((function(e){return{error:e.error,market:e.market}})).market.marketLoaded;Object(n.useEffect)((function(){l(k())}),[l]);return r.a.createElement("div",{className:"container my-3 mx-auto"},r.a.createElement("h1",{className:"display-4 text-center"},r.a.createElement("i",{className:"fas fa-map-marked mr-4"}),"Market Locator"),r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),a&&l(function(e){return function(t){t({type:"FILTER_MARKET",payload:e})}}(a))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search by market name",onChange:function(e){return c(e.target.value)}})),r.a.createElement("button",{className:"btn btn-secondary btn-block text-uppercase"},"Search")),r.a.createElement(g,null),r.a.createElement(f,{marketLoaded:o}))},_=function(){return function(){var e=Object(d.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"USER_LOADING"}),e.next=4,R.a.get("/api/v1/auth/secret");case 4:a=e.sent,t({type:"USER_LOADED",payload:a.data}),t({type:"CLEAR_ERROR"}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),t(v(e.t0.response.status,e.t0.response.data,"LOAD_USER_FAIL")),t({type:"AUTH_ERROR"});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},j=function(e){var t=e.message,a=e.type;return r.a.createElement("div",{className:"alert btn-block p-2 alert-".concat("error"===a?"danger":"success")},t)},L=function(e){var t=e.history,a=Object(b.b)(),c=Object(n.useState)(""),l=Object(m.a)(c,2),o=l[0],s=l[1],u=Object(n.useState)(""),p=Object(m.a)(u,2),E=p[0],f=p[1],g=Object(n.useState)(""),O=Object(m.a)(g,2),y=O[0],k=O[1],h=Object(b.c)((function(e){return{auth:e.auth,alert:e.alert}})),L=h.alert,N=h.auth,A=N.isAuthenticated,T=N.isLoading;Object(n.useEffect)((function(){return A&&t.push("/view_market"),function(){a({type:"CLEAR_ERROR"})}}),[A,t,a]);return r.a.createElement("div",{className:"admin py-5 mt-4 mx-auto"},r.a.createElement("h1",{className:"text-center text-uppercase"},"Admin Login"),r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),E&&y){var t,n={};n.email=E,n.password=y,a((t=n,function(){var e=Object(d.a)(i.a.mark((function e(a){var n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a({type:"USER_LOADING"}),n={headers:{"Content-type":"application/json"}},r=JSON.stringify(t),e.next=6,R.a.post("/api/v1/auth/signin",r,n);case 6:c=e.sent,a({type:"AUTH_LOGIN",payload:c.data}),a({type:"CLEAR_ERROR"}),a(_()),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),a(v(e.t0.response.status,e.t0.response.data,"LOGIN_FAIL")),a({type:"AUTH_ERROR"});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()))}else s("Please, ensure fields are not empty")},className:"mt-3 form"},""!==o?"LOGIN_FAIL"===L.id?r.a.createElement(j,{message:"Email or Password is incorrect!",type:"error"}):r.a.createElement(j,{message:o,type:"error"}):null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"email",name:"email",onChange:function(e){return f(e.target.value)},className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",onChange:function(e){return k(e.target.value)},className:"form-control"})),r.a.createElement("button",{className:"btn btn-block btn-secondary",disabled:!!T},"Login")))},N=function(e){var t=e.location;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-10 mx-auto text-center text-capitalize text uppercase pt-5"},r.a.createElement("h1",{className:"display-3"},"404"),r.a.createElement("h1",null,"error"),r.a.createElement("h2",null,"Page not found"),r.a.createElement("h3",null,"the requested URL",r.a.createElement("span",{className:"text-danger"},t.pathname)," was not found."))))},A=function(){var e=Object(b.b)();return r.a.createElement("ul",{className:"container mx-auto navbar justify-between list-unstyled"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/view_market"},"View Market")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/create_market"},"Post Market")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/login",onClick:function(){return e((function(e){e({type:"LOG_OUT",payload:{msg:"Logged out successfully"}})}))}},"Logout")))},T=function(){var e=Object(b.b)(),t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),s=Object(m.a)(o,2),u=s[0],p=s[1],E=Object(n.useState)(""),f=Object(m.a)(E,2),g=f[0],O=f[1],k=Object(n.useState)(""),h=Object(m.a)(k,2),_=h[0],L=h[1],N=Object(n.useState)(),T=Object(m.a)(N,2),S=T[0],x=T[1],M=Object(n.useState)(),w=Object(m.a)(M,2),D=w[0],C=w[1],I=Object(n.useState)(),F=Object(m.a)(I,2),U=F[0],K=F[1],G=Object(b.c)((function(e){return{alert:e.alert,market:e.market}})),H=G.alert,P=G.market.marketLoading;Object(n.useEffect)((function(){null!==H.msg&&l(H.msg)}),[l,H]);return r.a.createElement("div",{className:"admin py-5 mt-4 mx-auto"},r.a.createElement(A,null),r.a.createElement("h1",null,"Add New Market"),""!==c?null!==H.message?r.a.createElement(j,{message:c,type:"ADD_MARKET_SUCESS"===H.id?"success":"error"}):r.a.createElement(j,{message:c,type:"error"}):null,r.a.createElement("form",{className:"form",onSubmit:function(t){if(t.preventDefault(),u&&g&&_&&S&&D&&U){var a,n=new FormData;n.append("name",u),n.append("address",g),n.append("description",_),n.append("images",S),n.append("images",D),n.append("images",U),n.getAll("images"),e((a=n,function(){var e=Object(d.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"LOAD_REQUEST"}),n={headers:{"Content-Type":"application/json"}},e.next=5,R.a.post("/api/v1/market",a,n);case 5:r=e.sent,t({type:"ADD_MARKET",payload:r.data}),t(y(r.status,r.data,"ADD_MARKET_SUCESS")),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),t({type:"ADD_MARKET_ERROR"}),t(v(e.t0.response.status,e.t0.response.data,"ADD_MARKET_ERROR"));case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))}else l("Please, ensure fields are not empty")}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Market Name"),r.a.createElement("input",{type:"text",onChange:function(e){return p(e.target.value)},className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"address"},"Market Address"),r.a.createElement("input",{type:"text",onChange:function(e){return O(e.target.value)},className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"Market Description"),r.a.createElement("textarea",{name:"description",className:"form-control",onChange:function(e){return L(e.target.value)}})),r.a.createElement("div",{className:""},r.a.createElement("span",{className:"d-flex align-items-center"},r.a.createElement("h4",null,"Upload Image"),r.a.createElement("small",null,"(atleast 3 images of the market)")),r.a.createElement("div",null,r.a.createElement("input",{type:"file",onChange:function(e){return x(e.target.files[0])},className:"form-control mb-2"}),r.a.createElement("input",{type:"file",onChange:function(e){return C(e.target.files[0])},className:"form-control mb-2"}),r.a.createElement("input",{type:"file",onChange:function(e){return K(e.target.files[0])},className:"form-control mb-2"}))),r.a.createElement("button",{className:"btn btn-block btn-secondary text-uppercase",disabled:!!P},"Submit")))},S=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return{error:e.error,market:e.market}})).market,a=t.marketLoaded,c=t.marketLoading;Object(n.useEffect)((function(){e(k())}),[e]);var l=function(t){e(function(e){return function(){var t=Object(d.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"DELETE_MARKET_REQUEST",payload:e}),t.next=4,R.a.delete("/api/v1/market/".concat(e));case 4:a({type:"DELETE_MARKET",payload:e}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),a({type:"DELETE_MARKET_ERROR",payload:e}),a(v(t.t0.response.status,t.t0.response.data,"DELETE_MARKET_ERROR"));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(t))};return r.a.createElement("div",{className:"admin py-5 mt-4 mx-auto"},r.a.createElement(A,null),r.a.createElement("div",null,r.a.createElement("h1",null,"Registered Market(s)"),r.a.createElement("ul",{className:"list-group my-3"},c?r.a.createElement("li",null,r.a.createElement("h3",null,"Loading")):a&&a.map((function(e){return r.a.createElement("li",{className:"list-group-item d-flex justify-content-between align-items-center",key:e._id},e.name,r.a.createElement("span",{className:"btn badge badge-danger badge-pill",onClick:function(){return l(e._id)}},e.deleting?r.a.createElement(o.b,{to:"#"},"Delete..."):r.a.createElement(o.b,{to:"#"},r.a.createElement("em",null,"Delete"))))})))))},x=function(e){var t=e.match,a=Object(b.b)(),c=t.params.id,l=Object(b.c)((function(e){return{market:e.market}})).market,s=l.singleMarket,m=l.marketLoading;return Object(n.useEffect)((function(){a(function(e){return function(){var t=Object(d.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"LOAD_REQUEST"}),t.next=4,R.a.get("/api/v1/market/".concat(e));case 4:n=t.sent,a({type:"FETCH_SINGLE_MARKET",payload:n.data}),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0),a(v(t.t0.response.status,t.t0.response.data,"FETCH_SINGLE_MARKET_ERROR")),a({type:"FETCH_SINGLE_MARKET_ERROR"});case 13:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(c))}),[a,c]),m?r.a.createElement("p",{className:"lead mt-5 text-center"},"Loading..."):null!==s?r.a.createElement("div",{className:"mt-5 container"},r.a.createElement("button",{className:"btn btn-secondary text-white"},r.a.createElement(o.b,{to:"/"},"Back to homepage")),r.a.createElement("h1",{className:"text-capitalize my-4"},s.name),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"sub-division col-md-6 col-12"},r.a.createElement("i",{className:"fas fa-map-marker-alt fa-2x mr-3"}),r.a.createElement("span",null,r.a.createElement("h4",null,"Address"),r.a.createElement("p",null,s.location.formattedAddress))),r.a.createElement("div",{className:"col-md-6 col-12"},r.a.createElement("h4",null,"Description"),r.a.createElement("p",null,s.description)),r.a.createElement("div",{className:"row mx-auto"},s.image.map((function(e,t){return r.a.createElement("div",{className:"card card-image col-12 col-md-4",key:t},r.a.createElement("img",{src:e.url,alt:"",className:"img-fluid"}))})))),r.a.createElement(f,{marketLoaded:[s]})):r.a.createElement("h1",{className:"text-capilize my-5 text-center"},"Oops!, you've made a bad request")},M=a(40),w=r.a.memo((function(e){var t=e.component,a=Object(M.a)(e,["component"]),n=Object(b.c)((function(e){return{auth:e.auth}})).auth,c=n.isAuthenticated,l=n.token;return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return!l&&c?r.a.createElement(s.a,{to:"/"}):r.a.createElement(t,e)}}))})),D=function(){return r.a.createElement("section",null,r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/login",component:L}),r.a.createElement(w,{exact:!0,path:"/create_market",component:T}),r.a.createElement(w,{exact:!0,path:"/view_market",component:S}),r.a.createElement(s.b,{exact:!0,path:"/details/:id",component:x}),r.a.createElement(s.b,{component:N})))},C=function(e){e?R.a.defaults.headers={"Content-Type":"application/json",authorization:e}:(localStorage.removeItem("token"),delete R.a.defaults.headers.authorization)},I=a(15),F=a(38),U=a(1),K={token:localStorage.getItem("token"),isLoading:!1,user:null,msg:"",isAuthenticated:!1},G={msg:null,status:null,id:null},H=a(39),P={marketLoading:!1,marketLoaded:[],filterMarket:null,singleMarket:null},z=Object(I.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"USER_LOADING":return Object(U.a)(Object(U.a)({},e),{},{isLoading:!0});case"USER_LOADED":return Object(U.a)(Object(U.a)({},e),{},{user:n.data,isAuthenticated:!0,isLoading:!1});case"AUTH_REGISTER":case"AUTH_LOGIN":return localStorage.setItem("token",n.token),Object(U.a)(Object(U.a)({},e),{},{isLoading:!1,token:localStorage.getItem("token"),user:n.data,msg:n.msg,isAuthenticated:!0});case"RESET_STATE":return Object(U.a)(Object(U.a)({},e),{},{isLoading:!1,user:null,msg:"",isAuthenticated:!1});case"REGISTER_FAIL":case"LOGIN_FAIL":case"AUTH_ERROR":case"LOG_OUT":return localStorage.removeItem("token"),Object(U.a)(Object(U.a)({},e),{},{isAuthenticated:!1,isLoading:!1,user:null,token:null});default:return e}},alert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ALERT_ERROR":case"ALERT_SUCCESS":return{msg:t.payload.msg,status:t.payload.status,id:t.payload.id};case"CLEAR_ERROR":return{msg:null,status:null,id:null};default:return e}},market:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_REQUEST":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!0});case"FETCH_MARKET":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!1,marketLoaded:t.payload.data});case"ADD_MARKET":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!1,marketLoaded:[].concat(Object(H.a)(e.marketLoaded),[t.payload.data])});case"DELETE_MARKET_REQUEST":return Object(U.a)(Object(U.a)({},e),{},{marketLoaded:e.marketLoaded.map((function(e){return e._id===t.payload?Object(U.a)(Object(U.a)({},e),{},{deleting:!0}):e}))});case"DELETE_MARKET":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!1,marketLoaded:e.marketLoaded.filter((function(e){return e._id!==t.payload}))});case"FETCH_MARKET_ERROR":case"ADD_MARKET_ERROR":case"FETCH_SINGLE_MARKET_ERROR":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!1});case"DELETE_MARKET_ERROR":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!1,marketLoaded:e.marketLoaded.map((function(e){return e._id===t.payload?e.deleting=!1:e}))});case"FILTER_MARKET":return Object(U.a)(Object(U.a)({},e),{},{filterMarket:e.marketLoaded.filter((function(e){return e.name.toLowerCase().match(t.payload.toLowerCase())}))});case"FETCH_SINGLE_MARKET":return Object(U.a)(Object(U.a)({},e),{},{marketLoading:!1,singleMarket:t.payload.data});default:return e}}}),Q=[F.a],J=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||I.d,B=Object(I.e)(z,{},J(I.a.apply(void 0,Q)));a(69),a(70);var V=function(){return Object(n.useEffect)((function(){B.dispatch(_()),C(localStorage.token)}),[]),r.a.createElement(o.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:h}),r.a.createElement(s.b,{component:D}))))};l.a.render(r.a.createElement(b.a,{store:B},r.a.createElement(V,null)),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.701e7e59.chunk.js.map